---
title: "arg2"
---
```{r setup, include=FALSE}
library(tidyverse)
```
```{r}
simulation <- function() {
  action <- function() {
    if (is.na(slots[focused_feature])) { # is the slot with the FF still empty?
      if (revealed[focused_feature]) { # is the FF already visible?
        if (monster[focused_feature] == 'long') { # is the FF long?
          # then place this monster in the slot of the FF:
          slots[[focused_feature]] <<- monster
        }
      } else { # if FF is still covered:
        ## query the focused_feature => reveal it
        revealed[focused_feature] <<- TRUE
        queries <<- queries + 1
        action()
      }
    }
  }
  queries <- 0
  slots <- list(A = NA, B = NA)
  slots_need_to_be_filled <- TRUE
  while (slots_need_to_be_filled) {
    ## sample a monster
    monster <- c(A = sample(c('long', 'short'), 1), B = sample(c('long', 'short'), 1))
    revealed <- c(A = FALSE, B = FALSE)
    focused_feature_sequence <- sample(c('A', 'B'))
    focused_feature <- focused_feature_sequence[1]
    action()
    focused_feature <- focused_feature_sequence[2]
    action()
    slots_need_to_be_filled <- is.na(slots$A) || is.na(slots$B)
  }
  queries
}
simulation()
```
```{r}
replicate(10, simulation())
```


